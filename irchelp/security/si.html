<HTML>
<HEAD>
<TITLE>mIRC SCRIPT.INI Infosheet</TITLE>

<META NAME="description" CONTENT="Explanation of the script.ini `epidemic'
and what to do if you have SCRIPT.INI">

<META NAME="keywords" CONTENT="Microsoft Windows, dcc, script, script.ini">

<MAP NAME="banner_map">
<AREA SHAPE=RECT HREF="/irchelp/search_engine.cgi" COORDS="219,7,405,46">
<AREA SHAPE=RECT HREF="/irchelp/help.html" COORDS="219,68,405,107">
</MAP>

<MAP NAME="nav_map">
<AREA SHAPE=RECT HREF="/irchelp/" COORDS="1,1,70,38">
<AREA SHAPE=RECT HREF="/irchelp/search_engine.cgi" COORDS="72,1,141,38">
<AREA SHAPE=RECT HREF="/irchelp/help.html" COORDS="143,1,212,38">
<AREA SHAPE=RECT HREF="/irchelp/mail.cgi" COORDS="214,1,283,38">
</MAP>

</HEAD>

<BODY BGCOLOR="#FFFFE8" TEXT="#7A0818">

<A NAME="top">
<H1>Frequently Asked Questions: mIRC &quot;SCRIPT.INI&quot;</H1>

<SMALL>
by Rich Lafferty aka mendel<P>

The original version of this page is at &lt;<A
HREF="http://www.irchelp.org/irchelp/security/si.html">http://www.irchelp.org/irchelp/security/si.html</A>&gt;<BR>

Translations:
	<A HREF="http://www.irc.portal.ru/script_ini.html">Russian</A> |
	<A HREF="http://www.sodre.net/ernst/script-ini.htm">Portuguese</A> |
	<A HREF="http://w4u.eexi.gr/~shadow/irc/script-ini.html">Ελληνικά</A>
<P>
</SMALL>

<FONT COLOR="#FF0000"><B>Ed. note</B></FONT>: A new <A
	HREF="/irchelp/mirc/">mIRC 5.31</A> was released</B> recently which
	fixes many bugs and helps to prevent this attack.
	Check out the list of <A HREF="/irchelp/mirc/whatnew.txt">what's new</A>.
	It is highly recommended that all mIRC users upgrade!
	Failing that, at least delete all script.ini files on your disk,
	turn off auto DCC get (which is a really
	horrible and dangerous feature) and never accept DCC transfers
	from strangers!<P>

<blockquote>
<A HREF="#1"><h2>1. What is SCRIPT.INI?</h2></A>
<blockquote>
<A HREF="#1.1">1.1 Is SCRIPT.INI a virus?</A><br>
<A HREF="#1.2">1.2 Is SCRIPT.INI a trojan horse?</A><br>
<A HREF="#1.3">1.3 Are any other IRC clients vulnerable?</A><br>
</blockquote>
<A HREF="#2"><h2>2. What if I have SCRIPT.INI?</h2></A>
<blockquote>
<A HREF="#2.1">2.1 How do I know if I have SCRIPT.INI?</A><br>
<A HREF="#2.2">2.2 How do I get rid of SCRIPT.INI?</A><br>
<A HREF="#2.3">2.3 How can I prevent getting SCRIPT.INI?</A><br>
<A HREF="#2.4">2.4 But Auto-DCC-Get is convenient!</A><br>
<A HREF="#2.5">2.5 How can I prevent this from happening in the future?</A><br>
</blockquote>
<A HREF="#3"><h2>3. Miscellaneous Questions.</h2></A>
<blockquote>
<A HREF="#3.1">3.1 What will SCRIPT.INI do to my computer?</A><br>
<A HREF="#3.2">3.2 Will it hurt other files on my hard drive?</A><br>
<A HREF="#3.3">3.3 Will it affect other copies of mIRC?</A><br>
<A HREF="#3.4">3.4 Why would someone send me this thing?</A><br>
</blockquote></blockquote>
<br>
<hr>
<A NAME="1">
<H2>1. What is SCRIPT.INI?</H2>
<blockquote>
SCRIPT.INI is an mIRC script that is currently circulating the major IRC
networks at epidemic proportions. It is filled with commands to allow others 
to control your IRC session, watch your conversations, and disrupt your 
IRC session.<p>
It takes advantage of two potential security holes in the mIRC client, 
auto-DCC-get, and the automatic execution of files named SCRIPT.INI in the mIRC
directory.
</blockquote>
<p>
<A NAME="1.1">
<H4>1.1 Is SCRIPT.INI a virus?</H4>
<blockquote>
SCRIPT.INI is <i>not</i> a virus. Viruses reproduce on their own. SCRIPT.INI 
has to be willingly accepted by its host before reproducing. Even though
it most commonly is transmitted over auto-DCC-get, since users have to
turn on auto-DCC-get, it is not reproducing &quot;on its own&quot;.<p>
</blockquote>
<p>
<A NAME="1.2">
<H4>1.2 Is SCRIPT.INI a trojan horse?</H4>
<blockquote>
It <i>could</i> be considered a trojan horse. In the case where a user
sees someone sending them a script, and runs the script without examining
it first to see what it does, SCRIPT.INI acts as a trojan horse. However,
in the case of it being received with auto-DCC-get, it is not a trojan horse.
</blockquote>
<p>
<A NAME="1.3">
<H4>1.3 Are any other IRC clients vulnerable to SCRIPT.INI?</H4>
<blockquote>
SCRIPT.INI itself is in mIRC's scripting language, so only mIRC is vulnerable
to <i>this particular script</i>. However, this sort of exploit has been used for years
against the Unix IrcII client (as well as a similar exploit that would allow
an intruder to log in to your account without a password). Now that someone has
had this amount of success in circulating a backdoored script, it
could be expected that versions for other
popular clients will soon appear. The directions below for prevention should be
taken into consideration by <i>all</i> IRC users.
</blockquote>
<hr>
<A HREF="#top">[Return to top]</A><br>
<A NAME="2">
<H2>2. What if I have SCRIPT.INI?</H2>
<blockquote>
Quite simple: if you have it, delete it, and take steps to make sure that you
don't get it (or a similar problem) again. :)  How exactly <i>that</i> is done
is detailed below.
<p>
</blockquote>
<A NAME="2.1">
<H4>2.1 How do I know if I have SCRIPT.INI?</H4>
<blockquote>
The easiest way to see if you have SCRIPT.INI is to have someone tell you that
you are trying to send it to them. Failing that, you can look in your mIRC
directory for a file named script.ini.  Or, in either File Manager or Win95's 
Find File, you can search for script.ini over your whole hard drive.
<p>
<b>There have been reports of the file circulating under a different name</b>.
It is important, then, to make sure that you know the purpose of <i>all</i> the
files in your mIRC directory. If you find .ini or .mrc files that you don't 
recognize, open them up in a text editor such as Notepad. If you still don't
recognize them, delete them.
</blockquote>
<p>
<A NAME="2.2">
<H4>2.2 How do I get rid of SCRIPT.INI?</H4>
<blockquote>
When you find (or are told) that you are trying to send SCRIPT.INI to other people,
type <b>/events off</b>. This will stop the script from working -- but it is still
on your computer and loaded into mIRC.
<p>
<!-- The easy way to remove it is to type <b>/remove script.ini</b> to delete it from your mIRC directory. However, this doesn't always work. If you see the message, 
<pre>*** Removed c:\mirc\script.ini</pre> then you can rest assured that the
offending file was removed. Close mIRC and restart.
If you see the message, <pre>***/remove:no such file c:\mirc\script.ini</pre> then
the file was not removed.
-->
The only safe way to remove it is to do it manually, don't just use /remove
because sometimes people have gone so far as to alias /remove to make it *look*
like you deleted the file when it's really still there.
 Quit mIRC, and use File Manager or Explorer to delete
the file by hand from your mIRC directory. 
<p>
<i>And read on, we're not done yet...</i>
</blockquote>
<p>
<A NAME="2.3">
<H4>2.3 How can I prevent getting SCRIPT.INI?</H4>
<blockquote>
The first precaution to take is to ensure that Auto-DCC-Get is disabled. Under
the <b>DCC</b> menu, choose <b>Options...</b> and then the <b>Send</b> tab. The
safest option is to choose <b>Ignore</b> -- and that way you won't be bothered
with dialog boxes when other people try to send you SCRIPT.INI. Of course, this
means having to go in and change the setting to <b>Show get dialog</b> when you
want to let someone send you a file. This is worth the trouble.
<p>
The other option, of course, is to just use the <b>Show get dialog</b> option,
which necessitates a watchful eye to ensure you don't accept scripts like 
SCRIPT.INI. Don't get into the habit of automatically hitting &quot;OK&quot;.
</blockquote>
<p>
<A NAME="2.4">
<H4>2.4 But Auto-DCC-Get is convenient!</H4>
<blockquote>
This is true, but SCRIPT.INI is not the only way of exploiting the Auto-DCC-Get
feature. Since listing other ways here would serve as a menu of possible attacks,
you'll have to use your imagination. All and all, anything automatic that allows
other users to write to your hard drive is a bad thing.
</blockquote>
<p>
<A NAME="2.5">
<H4>2.5 How can I prevent this from happening in the future?</H4>
<blockquote>
The general answer to this question is, "don't use anything you
don't understand." The longer version of that answer is, "If you
don't understand what every single line in a script is, don't use it."
</blockquote>
<hr>
<A HREF="#top">[Return to top]</A><BR>
<A NAME="3">
<H2>3. Miscellaneous Questions</H2>
<A NAME="3.1">
<H4>3.1 What will SCRIPT.INI do to my computer?</H4>
<blockquote>
An incomplete list of SCRIPT.INI &quot;features&quot:
<ul>
  <li>Echo all of your channel talk, msgs, and notices to a particular channel.
  <li>On command from someone else, /quit IRC.
  <li>On command from someone else, allow people full run of your hard drive
  through an fserve.
  <li>Block or alter various server messages.
  <li>Alter your users list, and add protected users.
  <li>Send another user the passwd file from a UMSDOS Linux installation.
</ul>
</blockquote>
<A NAME="3.2">
<H4>3.2 Will it hurt other files on my hard drive? The hard drive itself?</H4>
<blockquote>
SCRIPT.INI will not hurt other files on your hard drive. However, it allows
malicious users to read, write and delete from your hard drive. SCRIPT.INI
will not damage your hardware. This does not guarantee that no future similar
exploits will not be capable of damaging hardware.
</blockquote>
<p>
<A NAME="3.3">
<H4>3.3 Will it affect other copies of mIRC?</H4>
<blockquote>
If you have multiple copies of mIRC in separate directories, infection of one
will not cause the others to be infected. However, the preventative steps above
should be followed for each copy of mIRC you have.
</blockquote>
<p>
<A NAME="3.4">
<H4>3.4 Why would someone send me this thing?</H4>
<blockquote>
It is easy to get angry at the people that try to send you SCRIPT.INI. Please 
keep in mind that they probably don't know that they are trying to send it, and
instead of getting angry at them, or kickbanning, or worse yet attacking them
back, please alert them of the problem and send them to #irchelp.
</blockquote>
<br>
<A HREF="#top">[Return to top]</A> 





<HR>

<CENTER>

<IMG SRC="/irchelp/Pix/ihnavbar.gif" WIDTH=285 HEIGHT=40 BORDER=0 USEMAP="#nav_map" ALT="-navigational bar-">
<P>

</CENTER>

<CENTER><SMALL>
<A HREF="/irchelp/credit.html">Copyright &copy; 1996,1997</A> Joseph Lo
and many others.<BR>
</SMALL></CENTER>

</BODY>
</HTML>





